---
layout: post
title: "「ミツデスマス2」を公開しました"
tags: [開発日記, OpenSiv3D, C/C++, お知らせ]
thumbnail: "/assets/img/thumbnails/feature-img/221225.png"
excerpt_separator: <!--more-->
---

メリークルシミマス！  

今年もキラキラカップルの陰で地道に社会を回す季節がやってきました。今年も平常運転です。  

例によって今年も毎年恒例のクリスマスゲームを作成いたしました。今年のタイトルは「ミツデスマス2」です。  

![title](../../../assets/img/post/2022-12-25/title.png)  

名前のとおり、一昨年の拙作「ミツデスマス」の続編です。まさかこれの続編が出るとは自分でも思ってませんでした。一昨年のものを改造したものなので完全新作ではありませんが、マップの追加やアイテム機能の追加など、独自要素が多々あります。まあ、気が向いたら遊んでみてください。

<!--more-->

ちなみに2016年以降毎年恒例だったゲーム作成ですが、おそらく今年で最後になるかと思います。  
もうネタ切れです。。ここ数年ネタがマンネリだったことからも明白で、今回が一昨年の改造版になったのもこれらが理由です。まあ、毎年恒例とまではいかなくとも隔年で作ることはあるかもしれませんが。

# ルール

![play](../../../assets/img/post/2022-12-25/play.png)  


基本的なルールはミツデスマスと一緒です。  
密になったカップルに近づき、スペースキーを押すことで「密です」と叫ぶ作業ゲーです。「密です」と叫べばカップルは距離を開けてくれます。これを制限時間内にマップ内のすべてのカップルに行うことが主なルールです。  
ただし、密じゃないカップルやクリぼっちもマップ内に存在しますので、間違えて「密です」しないようにお気を付けください。「密です」の回数には上限があります。 

## 操作方法

- 十字キー：プレイヤーの移動
- スペースキー：カップルに対して「密です」と叫ぶ / 障害物をブルドーザーで撤去する（今作での新要素）

# 追加要素

## 前作からの変更点

### MPの廃止

前作では4回ミスするとMPが0になりゲームオーバーでしたが、今作はMP自体を廃止。代わりに「密です」の回数に上限を設け、拡声器アイテム（後述）を拾うことで上限を1回ずつ増やせる仕様に変更。

### 「ちーがーうーだーろー」の削除

前作では密なカップル以外に「密です」すると「ちーがーうーだーろー」という吹き出しが表示されていましたが、元ネタ自体が古くなりつつあるので削除。代わりに「ミス」と表示するようにしました。

### HP回復方法の追加

プレイヤーが歩くとHPが減り、0になると歩行が低速になる仕様でしたが、前作では暫くの間立ち止まらなければHPは回復できませんでした。今作ではマップに落ちているチキンを食べることでHPを10回復できるようにしました。

### 障害物撤去機能の追加

山、木、建物といったマップ上の障害物を上限付きで撤去できるようにした。ブルドーザーを拾うことで上限を追加できるようにしました。

## アイテム

マップ上に落ちてるアイテムを拾うことで、それぞれの効果が得られます。  

- 拡声器: 残りの「密です」の回数を一回分増やす

- 腕時計: 残り時間を10秒追加する

- チキン: HPを10増やす

- ブルドーザー: 周囲の障害物（山、木、建物）に近づいてスペースキーを押したとき、その障害物を撤去できる

## その他の変更点

### OpenSiv3D v0.6.6 への対応

もともとのミツデスマスは OpenSiv3D v0.4.3 で開発していたので、バージョンアップに伴いライブラリも最新版である v0.6.6 に更新。マップデータ周りの処理を大幅に書き換える必要がありました。

### マップデータの形式の変更

前作では csv でマップを作成して json 形式に Python のスクリプトを用いて変換していたものの、面倒なので csv ファイルを直接読み込む方式に変更。マップをユーザの手で簡単に変更できるようにしました。

### スコアの保存

スコア、といっても残り時間ですが。  
ゲームクリア時点での残り時間の最長記録をファイルに記録する機能を追加しました。記録更新したら「スコア記録更新！」的な表示が出てきます。

### ステージのロック/アンロック

前作では最初から全部のステージで遊ぶことができましたが、今作ではステージをクリアしたら次のステージがアンロックされる方式に変更しました。

### バグの修正

主に当たり判定などを修正しました。

# 振り返り

今回は12月18日頃に作り始めたので開発期間は1週間足らずでした。こんな、典型的な「宿題を提出期日直前までやらないタイプの人」でもササッとゲームを作れるのが OpenSiv3D のよいところ。そもそも今回は既存のゲームの改造なのでシステム的な部分は既に完成していましたが、2年前も1週間程度でこのゲームを完成させていますので、いかに OpenSiv3D というライブラリが優れているかがよくわかります。  
とはいえ、師走は年々やらなければならないことが多い。今年はなんとかなったけど、来年以降はゲーム開発できなさそうだな…

# ダウンロードリンク

まだ配布ページを作成途中なので、GitHub のリポジトリからどうぞ。  
[https://github.com/YotioSoft/Mitsudesmas2/releases](https://github.com/YotioSoft/Mitsudesmas2/releases){:target="_blank"}
